<!DOCTYPE HTML>  
<html>  
<head>
<title>H5STREAM VIDEO</title>
<script src="js/jquery-3.1.1.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/adapter.js"></script>
<script src="js/platform.js"></script>
<script src="js/h5splayer.js"></script>
<script src="js/h5splayerhelper.js"></script>


<meta http-equiv="content-type" content="text/html;charset=utf-8">

<link rel = "stylesheet" type = "text/css" href = "css/h5splayer.css" />

</head>

<body> 

<div >
	<div class="row">
    <video class="h5video" id="h5sVideoLocal" playsinline autoplay muted="muted">
	</video>
	</div>

    <div class="select">
        <label for="videoCodec">Video Codec: </label><select id="videoCodec"></select>
    </div>
	
    <div class="select">
        <label for="videoSource">Video In: </label><select id="videoSource"></select>
    </div>
	
    <div class="select">
        <label for="audioSource">Audio In: </label><select id="audioSource"></select>
    </div>

    <div class="select">
        <label for="audioOutput">Audio Out: </label><select id="audioOutput"></select>
    </div>
	
    <div class="select">
        <label for="resolution">Resolution: </label><select id="resolution"></select>
    </div>

    <div class="select">
        <label for="bitrate">Bitrate(kpbs): </label><select id="bitrate"></select>
    </div>
	<div class="select">
		·¢ËÍÄÚÈÝ£º<input type="text" name="" id="sendcontent" value="" />
	</div>
	<button type="button" onclick="Connect()">Connect</button>
	<button type="button" onclick="Disconnect()">Disconnect</button>
	<button type="button" onclick="sendnews()">send</button>
	<div class="row">
	 <textarea style="margin: 0px; width: 800px; height: 400px;" id="event1"  ></textarea> 
	</div>

</div>

</body>

<script>
	
	const videoCodecSelect = document.querySelector('select#videoCodec');
	const videoSelect = document.querySelector('select#videoSource');
	const audioInputSelect = document.querySelector('select#audioSource');
	const audioOutputSelect = document.querySelector('select#audioOutput');
	const resolutionSelect = document.querySelector('select#resolution');
	const bitrateSelect = document.querySelector('select#bitrate');
	const sendcontent = document.getElementById("sendcontent");
	const toknemeeing = "9425"
	function UpdateCapability(capability){
		console.log(capability);
				
		
		for (let i = 0; i !== capability['videocodec'].length; ++i) {
			const data = capability['videocodec'][i];
			const option = document.createElement('option');
			option.value = data;
			option.text = data;
			/* Default use H264 */
			if (option.value == 'H264')
			{
				option.selected = true
			}
			videoCodecSelect.appendChild(option);
		}		
		

		for (let i = 0; i !== capability['videoin'].length; ++i) {
			const data = capability['videoin'][i];
			const option = document.createElement('option');
			option.value = data.id;
			option.text = data.name;
			videoSelect.appendChild(option);
		}	

		for (let i = 0; i !== capability['audioin'].length; ++i) {
			const data = capability['audioin'][i];
			const option = document.createElement('option');
			option.value = data.id;
			option.text = data.name;
			audioInputSelect.appendChild(option);
		}
		
		for (let i = 0; i !== capability['audioout'].length; ++i) {
			const data = capability['audioout'][i];
			const option = document.createElement('option');
			option.value = data.id;
			option.text = data.name;
			audioOutputSelect.appendChild(option);
		}
		
		var resolution = ['QVGA', 'VGA', 'D1', '720P', '1080P', '4K', '8K']
		for (let i = 0; i !== resolution.length; ++i) {
			const data = resolution[i];
			const option = document.createElement('option');
			option.value = data;
			option.text = data;
			/* Default use 720P */
			if (option.value == '720P')
			{
				option.selected = true
			}
			resolutionSelect.appendChild(option);
		}
		
		var bitrate = ['32', '64', '128', '256', '512', '1024', '2048', '4096']
		for (let i = 0; i !== bitrate.length; ++i) {
			const data = bitrate[i];
			const option = document.createElement('option');
			option.value = data;
			option.text = data;
			/* Default use 720P */
			if (option.value == '1024')
			{
				option.selected = true
			}
			bitrateSelect.appendChild(option);
		}
		
	}

	H5sRTCGetCapability(UpdateCapability, 
									function(){
										console.log('RTC do not support !'); 
									});
	var bDesktopSharing = false;
	var pushType = 'media';
	if (bDesktopSharing == true)
	{
		pushType = 'sharing';
	}

	var conf1 = {
		localvideoid:'h5sVideoLocal', //{string} - id of the local video element tag
		//localvideodom: h5svideodomlocal, //{object} - local video dom. if there has videoid, just use the videoid
		protocol: window.location.protocol, //http: or https:
		host: window.location.host, //localhost:8080
		rootpath:'/', // {string} - path of the app running
		user:'user1', // {string} - user name
		type: pushType, // {string} - media or sharing
		audio: 'true', // 'true' or 'false' enable/disable audio
		callback: null, //Callback for the event
		userdata: null, // user data
		session: 'c1782caf-b670-42d8-ba90-2244d0b0ee83', //session got from login
		consolelog: 'true' // 'true' or 'false' enable/disable console.log
	};
	$('#h5sVideoLocal').get(0).volume = 0;
	$('#h5sVideoLocal').get(0).muted  = 0;

	var v1;
	
	function Connect()
	{
		console.log(conf1);
		v1 = new H5sRTCPush(conf1);
		v1.connect(videoSelect.value, videoCodecSelect.value, bitrateSelect.value, 
						resolutionSelect.value,  audioInputSelect.value, bDesktopSharing);
	}
	function sendnews(){
		console.log(sendcontent.value)
		var sends = {
			token:sendcontent.value,
			news:sendcontent.value
		}
		v1.send(toknemeeing, sendcontent.value)
	}
	function Disconnect()
	{
		console.log("Disconnect");
		v1.disconnect();
	}

	




</script>

</html> 